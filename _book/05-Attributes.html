<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.0.38">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Spatial Data Science - 5&nbsp; Attributes and Support</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./06-part-2.html" rel="next">
<link href="./04-Spherical.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Attributes and Support</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Spatial Data Science</a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Preface</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./00-part-1.html" class="sidebar-item-text sidebar-link">Spatial Data</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-hello.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Getting Started</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-Spaces.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Coordinates</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-Geometries.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Geometries</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-Spherical.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Spherical Geometries</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-Attributes.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Attributes and Support</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./06-part-2.html" class="sidebar-item-text sidebar-link">R for Spatial Data Science</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-Cubes.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Data Cubes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-Introsf.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Introduction to sf and stars</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-Large.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Large data and cloud native</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-Plotting.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Plotting spatial data</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./10-part-3.html" class="sidebar-item-text sidebar-link">Models for Spatial Data</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-Models.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Statistical modelling of spatial data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13-PointPattern.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Point Pattern Analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./14-Interpolation.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Spatial Interpolation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./16-Geostatistics.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Multivariate and Spatiotemporal Geostatistics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./17-Areal.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Proximity and Areal Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./18-SpatialRegression.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Spatial Regression</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./30-sp-raster.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Older R Spatial Packages</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./97-allcode.html" class="sidebar-item-text sidebar-link">All R code in this book</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./98-rbascis.html" class="sidebar-item-text sidebar-link">R basics</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">Index</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#sec-agr" id="toc-sec-agr" class="nav-link active" data-scroll-target="#sec-agr"> <span class="header-section-number">5.1</span> Attribute-geometry relationships and support</a></li>
  <li><a href="#aggregating-and-summarising" id="toc-aggregating-and-summarising" class="nav-link" data-scroll-target="#aggregating-and-summarising"> <span class="header-section-number">5.2</span> Aggregating and summarising</a></li>
  <li><a href="#sec-area-weighted" id="toc-sec-area-weighted" class="nav-link" data-scroll-target="#sec-area-weighted"> <span class="header-section-number">5.3</span> Area-weighted interpolation</a>
  <ul class="collapse">
  <li><a href="#sec-extensiveintensive" id="toc-sec-extensiveintensive" class="nav-link" data-scroll-target="#sec-extensiveintensive">Spatially extensive and intensive variables</a></li>
  <li><a href="#dasymetric-mapping" id="toc-dasymetric-mapping" class="nav-link" data-scroll-target="#dasymetric-mapping">Dasymetric mapping</a></li>
  <li><a href="#support-in-file-formats" id="toc-support-in-file-formats" class="nav-link" data-scroll-target="#support-in-file-formats">Support in file formats</a></li>
  </ul></li>
  <li><a href="#sec-updownscaling" id="toc-sec-updownscaling" class="nav-link" data-scroll-target="#sec-updownscaling"> <span class="header-section-number">5.4</span> Up- and Downscaling</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="sec-featureattributes" class="quarto-section-identifier d-none d-lg-block"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Attributes and Support</span></span></h1>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<p>Feature <em>attributes</em> refer to the properties of features (“things”) that do not describe the feature’s geometry. Feature attributes can be <em>derived</em> from geometry (e.g.&nbsp;length of a <code>LINESTRING</code>, area of a <code>POLYGON</code>) but they can also refer to non-derived properties, such as:</p>
<ul>
<li>the name of a street or a county</li>
<li>the number of people living in a country</li>
<li>the type of a road</li>
<li>the soil type in a polygon from a soil map</li>
<li>the opening hours of a shop</li>
<li>the body weight or heart beat rate of an animal</li>
<li>the NO<span class="math inline">\(_2\)</span> concentration measured at an air quality monitoring station</li>
</ul>
<p>In some cases, time properties can be seen as attributes of features, e.g.&nbsp;the date of birth of a person or the construction year of a road. When an attribute such as for instance air quality is a function of both space and time, time is best handled on equal footing with geometry (e.g.&nbsp;in a data cube, see <a href="06-Cubes.html"><span>Chapter&nbsp;6</span></a>).</p>
<p>Spatial data science software implementing simple features typically organizes data in tables that contain both geometries and attributes for features; this is true for <code>geopandas</code> in Python, <code>PostGIS</code> tables in PostgreSQL, and <code>sf</code> objects in R. The geometric operations described in <a href="03-Geometries.html#sec-opgeom"><span>Section&nbsp;3.2</span></a> operate on geometries <em>only</em>, and may occasionally yield new attributes (predicates, measures or transformations), but do not operate on attributes present.</p>
<p>When, while manipulating geometries, attribute <em>values</em> are retained unmodified, support problems may arise. If we look into a simple case of replacing a county polygon with the centroid of that polygon on a dataset that has attributes, we see that R package <code>sf</code> issues a warning:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressPackageStartupMessages</span>(<span class="fu">library</span>(sf))</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressPackageStartupMessages</span>(<span class="fu">library</span>(dplyr))</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">system.file</span>(<span class="st">"gpkg/nc.gpkg"</span>, <span class="at">package=</span><span class="st">"sf"</span>) <span class="sc">|&gt;</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">read_sf</span>() <span class="sc">|&gt;</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">st_transform</span>(<span class="dv">32119</span>) <span class="sc">|&gt;</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(BIR74, SID74, NAME) <span class="sc">|&gt;</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">st_centroid</span>() <span class="ot">-&gt;</span> x</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Warning in</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co"># st_centroid.sf(select(st_transform(read_sf(system.file("gpkg/</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co"># nc.gpkg", : st_centroid assumes attributes are constant over</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co"># geometries of x</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The reason for this is that the dataset contains variables with values that are associated with entire polygons – in this case: population counts – meaning they are not associated with a <code>POINT</code> geometry replacing the polygon.</p>
<p>In <a href="01-hello.html#sec-support"><span>Section&nbsp;1.6</span></a> we already described that for non-point geometries (lines, polygons), feature attribute values either have <em>point support</em>, meaning that the value applies to <em>every point</em>, or they have <em>block support</em>, meaning that the value <em>summarizes all points</em> in the geometry. (More complex options, e.g.&nbsp;in between these two extremes, may also occur.) This chapter will describe different ways in which an attribute may relate to the geometry, its consequences on analysing such data, and ways to derive attribute data for different geometries (up- and downscaling).</p>
<section id="sec-agr" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="sec-agr"><span class="header-section-number">5.1</span> Attribute-geometry relationships and support</h2>
<p>Changing the feature geometry without changing the feature attributes does change the <em>feature</em>, since the feature is characterised by the combination of geometry and attributes. Can we, ahead of time, predict whether the resulting feature will still meaningfully relate to the attribute value when we replace all geometries for instance with their convex hull or centroid? It depends.</p>
<p>Take the example of a road, represented by a <code>LINESTRING</code>, which has an attribute property <em>road width</em> equal to 10 m. What can we say about the road width of an arbitrary subsection of this road? That depends on whether the attribute road length describes, for instance the road width <em>everywhere</em>, meaning that road width is constant along the road, or whether it describes an aggregate property, such as minimum or average road width. In case of the minimum, for an arbitrary subsection of the road one could still argue that the minimum road width must be at least as large as the minimum road width for the whole segment, but it may no longer be <em>the minimum</em> for that subsection. This gives us two “types” for the attribute-geometry relationship (<strong>AGR</strong>):</p>
<ul>
<li><strong>constant</strong> the attribute value is valid everywhere in or over the geometry; we can think of the feature as consisting of an infinite number of points that all have this attribute value; in the geostatistical literature this is known as a variable with <em>point support</em></li>
<li><strong>aggregate</strong> the attribute is an aggregate, a summary value over the geometry; we can think of the feature as a <em>single</em> observation with a value that is associated with the <em>entire</em> geometry; this is also known as a variable having <em>block support</em></li>
</ul>
<p>For polygon data, typical examples of <strong>constant</strong> AGR (point support) variables are:</p>
<ul>
<li>land use for a land use polygon</li>
<li>rock units or geologic strata in a geological map</li>
<li>soil type in a soil map</li>
<li>elevation class in a elevation map that shows elevation as classes</li>
<li>climate zone in a climate zone map</li>
</ul>
<p>A typical property of such variables is that they have geometries that are not man-made and also not associated with a sensor device (such as remote sensing image pixel boundaries). Instead, the geometry follows from the variable observed.</p>
<p>Examples for the <strong>aggregate</strong> AGR (block support) variables are:</p>
<ul>
<li>population, either as number of persons or as population density</li>
<li>other socio-economic variables, summarised by area</li>
<li>average reflectance over a remote sensing pixel</li>
<li>total emission of pollutants by region</li>
<li>block mean NO<span class="math inline">\(_2\)</span> concentrations, as e.g.&nbsp;obtained by block kriging over square blocks or a dispersion model that predicts areal means</li>
</ul>
<p>A typical property of such variables is that associated geometries come for instance from legislation, observation devices or analysis choices, but not intrinsically from the observed variable.</p>
<p>A third type of AGR arises when an attribute <em>identifies</em> a feature geometry; we call an attribute an <strong>identity</strong> variable when the associated geometry uniquely identifies the variable’s value (there are no other geometries with the same value). An example is county name: the name identifies the county, and is still the county for any sub-area (point support), but for arbitrary sub-areas, the attributes loses the <strong>identity</strong> property to become a <strong>constant</strong> attribute. An example is:</p>
<ul>
<li>an arbitrary point (or region) inside a county is still part of the county and must have the same value for county name, but it does not longer identify the (entire) geometry corresponding to that county</li>
</ul>
<p>The challenge here is that spatial information (ignoring time for simplicity) belongs to different phenomena types <span class="citation" data-cites="scheider2016">(e.g. <a href="references.html#ref-scheider2016" role="doc-biblioref">Scheider et al. 2016</a>)</span>, including:</p>
<ul>
<li><strong>fields</strong>: where over <em>continuous</em> space, every location corresponds to a single value, e.g.&nbsp;elevation, air quality, or land use</li>
<li><strong>objects</strong>: found at a <em>discrete</em> set of locations, e.g.&nbsp;houses or persons</li>
<li><strong>aggregates</strong>: e.g.&nbsp;sums, totals, averages of fields, counts or densities of objects, associated with lines or regions</li>
</ul>
<p>but that different spatial geometry types (points, lines, polygons, raster cells) have no simple mapping to these phenomena types:</p>
<ul>
<li>points may refer to sample locations of observations on fields (air quality) or to locations of objects</li>
<li>lines may be used for objects (roads, rivers), contours of a field, or administrative borders</li>
<li>raster pixels and polygons may reflect fields of a categorical variable such as land use (<em>coverage</em>), but also aggregates such as population density</li>
</ul>
<p>Properly specifying attribute-geometry relationships, and warning against their absence or cases when change in geometry (change of support) implies a change of information can help avoiding a large class of common spatial data analysis mistakes <span class="citation" data-cites="stasch2014">(<a href="references.html#ref-stasch2014" role="doc-biblioref">Stasch et al. 2014</a>)</span> associated with the <em>support</em> of spatial data.</p>
</section>
<section id="aggregating-and-summarising" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="aggregating-and-summarising"><span class="header-section-number">5.2</span> Aggregating and summarising</h2>
<p>Aggregating records in a table (or <code>data.frame</code>) involves two steps:</p>
<ul>
<li>grouping records based on a grouping predicate, and</li>
<li>applying an aggregation function to the attribute values of a group to summarize them into a single number.</li>
</ul>
<p>In SQL, this looks for instance like</p>
<pre><code>SELECT GroupID, SUM(population) FROM table GROUP BY GroupID;</code></pre>
<p>indicating the aggregation <em>function</em> (<code>SUM</code>) and the <em>grouping predicate</em> (<code>GroupID</code>).</p>
<p>R package <code>dplyr</code> for instance uses two steps to accomplish this: function <code>group_by</code> specifies the group membership of records, <code>summarize</code> computes data summaries (such as <code>sum</code> or <code>mean</code>) for each of the groups. R (base) function <code>aggregate</code> does both in a single function that takes the data table, the grouping predicate(s) and the aggregation function.</p>
<p>An example for the North Carolina counties is shown in <a href="#fig-ncaggregation">Figure&nbsp;<span>5.1</span></a>. Here, we grouped counties by their position (according to the quadrant in which the county centroid is with respect to ellipsoidal coordinate <code>POINT(-79, 35.5)</code>) and counted the number of disease cases per group. The result shows that the geometries of the resulting groups have been unioned (<a href="03-Geometries.html#sec-bintrans"><span>Section&nbsp;3.2.6</span></a>): this is necessary because the <code>MULTIPOLYGON</code> formed by just putting all the county geometries together would have many duplicate boundaries, and hence not be <em>valid</em> (<a href="03-Geometries.html#sec-valid"><span>Section&nbsp;3.1.2</span></a>).</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>nc <span class="ot">&lt;-</span> <span class="fu">read_sf</span>(<span class="fu">system.file</span>(<span class="st">"gpkg/nc.gpkg"</span>, <span class="at">package =</span> <span class="st">"sf"</span>))</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co"># encode quadrant by two logicals:</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>nc<span class="sc">$</span>lng <span class="ot">&lt;-</span> <span class="fu">st_coordinates</span>(<span class="fu">st_centroid</span>(<span class="fu">st_geometry</span>(nc)))[,<span class="dv">1</span>] <span class="sc">&gt;</span> <span class="sc">-</span><span class="dv">79</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>nc<span class="sc">$</span>lat <span class="ot">&lt;-</span> <span class="fu">st_coordinates</span>(<span class="fu">st_centroid</span>(<span class="fu">st_geometry</span>(nc)))[,<span class="dv">2</span>] <span class="sc">&gt;</span> <span class="fl">35.5</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>nc.grp <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(nc[<span class="st">"SID74"</span>], <span class="fu">list</span>(nc<span class="sc">$</span>lng, nc<span class="sc">$</span>lat), sum)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(nc.grp[<span class="st">"SID74"</span>], <span class="at">axes =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-ncaggregation" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="05-Attributes_files/figure-html/fig-ncaggregation-1.png" class="img-fluid figure-img" style="width:70.0%"></p>
<p></p><figcaption class="figure-caption">Figure 5.1: SID74 counts by county quadrant, with county polygons unioned by county quadrant</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Plotting collated county polygons is technically not a problem, but for this case would raise the wrong suggestion that the group sums relate to the counties, and not the group of counties.</p>
<p>One particular property of aggregation in this way is that each record is assigned to a single group; this has the advantage that the sum of the group-wise sums equals the sum of the ungrouped data: for variables that reflect <em>amount</em>, nothing gets lost and nothing is added. The newly formed geometry is the result of unioning the geometries of the records.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>nc <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(nc, <span class="dv">2264</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>gr <span class="ot">&lt;-</span> <span class="fu">st_sf</span>(</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>   <span class="at">label =</span> <span class="fu">apply</span>(<span class="fu">expand.grid</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, LETTERS[<span class="dv">10</span><span class="sc">:</span><span class="dv">1</span>])[,<span class="dv">2</span><span class="sc">:</span><span class="dv">1</span>], <span class="dv">1</span>, paste0, <span class="at">collapse =</span> <span class="st">" "</span>),</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>   <span class="at">geom =</span> <span class="fu">st_make_grid</span>(nc))</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">st_geometry</span>(nc), <span class="at">reset =</span> <span class="cn">FALSE</span>, <span class="at">border =</span> <span class="st">'grey'</span>)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">st_geometry</span>(gr), <span class="at">add =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-ncblocks" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="05-Attributes_files/figure-html/fig-ncblocks-1.png" class="img-fluid figure-img" style="width:70.0%"></p>
<p></p><figcaption class="figure-caption">Figure 5.2: example target blocks layed out over North Carolina counties</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>When we need an aggregate for a new area that is <em>not</em> a union of the geometries for a group of records, and we use a spatial predicate then single records may be matched to multiple groups. When taking the rectangles of <a href="#fig-ncblocks">Figure&nbsp;<span>5.2</span></a> as the target areas, and summing for each rectangle the disease cases of the counties that <em>intersect</em> with the rectangles of <a href="#fig-ncblocks">Figure&nbsp;<span>5.2</span></a> , the sum of these will be much larger:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(nc[<span class="st">"SID74"</span>], gr, sum)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="at">sid74_sum_counties =</span> <span class="fu">sum</span>(nc<span class="sc">$</span>SID74), <span class="at">sid74_sum_rectangles =</span> <span class="fu">sum</span>(a<span class="sc">$</span>SID74, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   sid74_sum_counties sid74_sum_rectangles </span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co">#                  667                 2621</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Choosing another predicate, e.g.&nbsp;<em>contains</em> or <em>covers</em> would on the contrary result in much smaller values, because many counties are not contained by <em>any</em> the target geometries. However, there are a few cases where this approach might be good or satisfactory:</p>
<ul>
<li>when we want to aggregate <code>POINT</code> geometries by a set of polygons, and all points are contained by a single polygon. If points fall on a shared boundary than they are assigned to both polygons (this is the case for DE-9IM-based GEOS library; the s2geometry library has the option to define polygons as “semi-open”, which implies that points are assigned to single polygons when the polygons form a coverage)</li>
<li>when aggregating many very small polygons or raster pixels over larger areas, e.g.&nbsp;averaging altitude from 30 m resolution raster over North Carolina counties, the error made by multiple matches may be insignificant</li>
</ul>
<p>A more comprehensive approach to aggregating spatial data associated to areas to larger, arbitrary shaped areas is by using area-weighted interpolation.</p>
</section>
<section id="sec-area-weighted" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="sec-area-weighted"><span class="header-section-number">5.3</span> Area-weighted interpolation</h2>
<p>When we want to combine geometries and attributes of two datasets such that we get attribute values of a source dataset summarised for the geometries of a target, where source and target geometries are unrelated, area-weighted interpolation may be a simple approach. In effect, it considers the area of overlap of the source and target geometries, and uses that to weight the source attribute values into the target value <span class="citation" data-cites="goodchild thomas do Do2021">(<a href="references.html#ref-goodchild" role="doc-biblioref">Goodchild and Lam 1980</a>; <a href="references.html#ref-thomas" role="doc-biblioref">Do, Thomas-Agnan, and Vanhems 2015a</a>, <a href="references.html#ref-do" role="doc-biblioref">2015b</a>; <a href="references.html#ref-Do2021" role="doc-biblioref">Do, Laurent, and Vanhems 2021</a>)</span>. Here, we follow the notation of <span class="citation" data-cites="do">Do, Thomas-Agnan, and Vanhems (<a href="references.html#ref-do" role="doc-biblioref">2015b</a>)</span>.</p>
<p>Area-weighted interpolation computes, for each of <span class="math inline">\(q\)</span> spatial target areas <span class="math inline">\(T_j\)</span>, a weighted average from the values <span class="math inline">\(Y_i\)</span> corresponding to the <span class="math inline">\(p\)</span> spatial source areas <span class="math inline">\(S_i\)</span>,</p>
<p><span id="eq-aw"><span class="math display">\[
\hat{Y}_j(T_j) = \sum_{i=1}^p w_{ij} Y_i(S_i)
\tag{5.1}\]</span></span></p>
<p>where the <span class="math inline">\(w_{ij}\)</span> depend on the amount of overlap of <span class="math inline">\(T_j\)</span> and <span class="math inline">\(S_i\)</span>, and the amount of overlap is <span class="math inline">\(A_{ij} = T_j \cap S_i\)</span>. How <span class="math inline">\(w_{ij}\)</span> depends on <span class="math inline">\(A_{ij}\)</span> is discussed below.</p>
<p>Different options exist for choosing weights, including methods using external variables (e.g.&nbsp;dasymetric mapping, <span class="citation" data-cites="mennis">Mennis (<a href="references.html#ref-mennis" role="doc-biblioref">2003</a>)</span>). Two simple approaches for computing weights that do not use external variables arise, depending on whether the variable <span class="math inline">\(Y\)</span> is <em>intensive</em> or <em>extensive</em>.</p>
<section id="sec-extensiveintensive" class="level3">
<h3 class="anchored" data-anchor-id="sec-extensiveintensive">Spatially extensive and intensive variables</h3>
<p>An example of a extensive variable is <em>population count</em>. It is associated with an area, and if that area is cut into smaller areas, the population count is split accordingly: not necessary proportional to area, because population is rarely uniform, but split in such a way that the sum of the population count for the smaller areas equals that of the total. An example of a related variable that is <em>intensive</em> is population density. If an area is split into smaller areas, population density is not split similarly: the sum of the population densities for the smaller areas is a meaningless measure, as opposed to the average of the population densities which will be similar to the density of the total area.</p>
<p>Extensive variables correspond to amounts, associated with a physical size (length, area, volume); for <em>spatially</em> extensive variables, if the area a value corresponds to is cut in parts, the values associated with the sub-area are split accordingly. In other words: the value is proportional to the support. Intensive variables are variables that do not have values proportional to support: if the area is split, values may vary but <em>on average</em> remain the same. The corresponding example of an intensive variable is <em>population density</em>: when we split an area into sub-areas, the sub-areas either have identical population densities (in case population is uniformly distributed) or, more realistically, have <em>varying</em> population densities that by necessity are both higher and lower than the density of the total area.</p>
<p>When we assume that the extensive variable <span class="math inline">\(Y\)</span> is uniformly distributed over space, the value <span class="math inline">\(Y_{ij}\)</span>, derived from <span class="math inline">\(Y_i\)</span> for a sub-area of <span class="math inline">\(S_i\)</span>, <span class="math inline">\(A_{ij} = T_j \cap S_i\)</span> of <span class="math inline">\(S_i\)</span> is</p>
<p><span class="math display">\[\hat{Y}_{ij}(A_{ij}) = \frac{|A_{ij}|}{|S_i|} Y_i(S_i)\]</span></p>
<p>where <span class="math inline">\(|\cdot|\)</span> denotes the spatial area. For estimating <span class="math inline">\(Y_j(T_j)\)</span> we sum all the elements over area <span class="math inline">\(T_j\)</span>:</p>
<p><span id="eq-awextensive"><span class="math display">\[
\hat{Y}_j(T_j) = \sum_{i=1}^p \frac{|A_{ij}|}{|S_i|} Y_i(S_i)
\tag{5.2}\]</span></span></p>
<p>For an intensive variable, under the assumption that the variable has a constant value over each area <span class="math inline">\(S_i\)</span>, the estimate for a sub-area equals that of the total,</p>
<p><span class="math display">\[\hat{Y}_{ij} = Y_i(S_i)\]</span></p>
<p>and we can estimate the value of <span class="math inline">\(Y\)</span> for a new spatial unit <span class="math inline">\(T_j\)</span> by an area-weighted average of the source values:</p>
<p><span id="eq-awintensive"><span class="math display">\[
\hat{Y}_j(T_j) = \sum_{i=1}^p \frac{|A_{ij}|}{|T_j|} Y_i(S_i)
\tag{5.3}\]</span></span></p>
</section>
<section id="dasymetric-mapping" class="level3">
<h3 class="anchored" data-anchor-id="dasymetric-mapping">Dasymetric mapping</h3>
<p>Dasymetric mapping distributes variables, such as population, known at a coarse spatial aggregation level over finer spatial units by using other variables that are associated with population distribution, such as land use, building density, or road density. The simplest approach to dasymetric mapping is obtained for extensive variables, where the ratio <span class="math inline">\(|A_{ij}| / |S_i|\)</span> in (<a href="#eq-awextensive">Equation&nbsp;<span>5.2</span></a>) is replaced by the ratio of another extensive variable <span class="math inline">\(X_{ij}(S_{ij})/X_i(S_i)\)</span>, which has to be known for both the intersecting regions <span class="math inline">\(S_{ij}\)</span> and the source regions <span class="math inline">\(S_i\)</span>. <span class="citation" data-cites="do">Do, Thomas-Agnan, and Vanhems (<a href="references.html#ref-do" role="doc-biblioref">2015b</a>)</span> discuss several alternatives for intensive <span class="math inline">\(Y\)</span> and/or <span class="math inline">\(X\)</span>, and cases where <span class="math inline">\(X\)</span> is known for other areas.</p>
</section>
<section id="support-in-file-formats" class="level3">
<h3 class="anchored" data-anchor-id="support-in-file-formats">Support in file formats</h3>
<p>GDAL’s vector API supports reading and writing so-called field domains, which can have a “split policy” and a “merge policy” indicating what should be done with attribute variables when geometries are split or merged. The values of these can be “duplicate” for split and “geometry weighted” for merge, in case of spatially intensive variables, or they can be “geometry ratio” for split and “sum” for merge, in case of spatially extensive variables. At the time of writing this, the <a href="https://github.com/OSGeo/gdal/pull/3638">file formats supporting this</a> are GeoPackage and FileGDB.</p>
</section>
</section>
<section id="sec-updownscaling" class="level2" data-number="5.4">
<h2 data-number="5.4" class="anchored" data-anchor-id="sec-updownscaling"><span class="header-section-number">5.4</span> Up- and Downscaling</h2>
<p>Up- and downscaling refers in general to obtaining high-resolution information from low-resolution data (downscaling) or obtaining low-resolution information from high-resolution data (upscaling). Both are activities involve attributes’ relation to geometries and both change support. They are synonymous with aggregation (upscaling) and disaggregation (downscaling).</p>
<p>The simplest form of downscaling is sampling (or extracting) polygon, line or grid cell values at point locations. This works well for variables with point-support (“constant” AGR), but is at best approximate when the values are aggregates.</p>
<p>Challenging applications for downscaling include high-resolution prediction of variables obtained by low-resolution weather prediction models or climate change models, and the high-resolution prediction of satellite image derived variables based on the fusion of sensors with different spatial and temporal resolutions.</p>
<p>The application of areal interpolation using (<a href="#eq-aw">Equation&nbsp;<span>5.1</span></a>) with its realisations for extensive (<a href="#eq-awextensive">Equation&nbsp;<span>5.2</span></a>) and intensive (<a href="#eq-awintensive">Equation&nbsp;<span>5.3</span></a>) variables allows moving information from any source area <span class="math inline">\(S_i\)</span> to any target area <span class="math inline">\(T_j\)</span> as long as the two areas have some overlap. This means that one can go arbitrarily to much larger units (aggregation) or to much smaller units (disaggregation). Of course this makes only sense to the extent that the assumptions hold: over the source regions extensive variables need to be uniformly distributed and intensive variables need to have constant value.</p>
<p>The ultimate disaggregation involves retrieving (extracting) point values from line or area data. For this, we cannot work with equations (<a href="#eq-awextensive">Equation&nbsp;<span>5.2</span></a>) or (<a href="#eq-awintensive">Equation&nbsp;<span>5.3</span></a>) because <span class="math inline">\(|A_{ij}| = 0\)</span> for points, but under the assumption of having a constant value over the geometry, for intensive variables the value <span class="math inline">\(Y_i(S_i)\)</span> can be assigned to points as long as all points can be uniquely assigned to a single source area <span class="math inline">\(S_i\)</span>. For polygon data, this implies that <span class="math inline">\(Y\)</span> needs to be a coverage variable (<a href="03-Geometries.html#sec-coverages"><span>Section&nbsp;3.4</span></a>).</p>
<p>In cases where values associated with areas are <strong>aggregate</strong> values over the area, the assumptions made by area-weighted interpolation or dasymetric mapping – uniformity or constant values over the source areas – are highly unrealistic. In such cases, these simple approaches still be reasonable approximations, for instance when:</p>
<ul>
<li>the source and target area are nearly identical</li>
<li>the variability inside source units is very small, and the variable is nearly uniform or constant</li>
</ul>
<p>In other cases, results obtained using these methods are merely consequences of unjustified assumptions. Statistical aggregation methods that can estimate quantities for larger regions from points or smaller regions include:</p>
<ul>
<li>design-based methods, which require that a probability sample is available from the target region, with known inclusion probabilities (<span class="citation" data-cites="brus2021">Brus (<a href="references.html#ref-brus2021" role="doc-biblioref">2021</a>)</span>, <a href="10-Models.html#sec-design"><span>Section&nbsp;10.1</span></a>), and</li>
<li>model-based methods, which assume a random field model with spatially correlated values (block kriging, <a href="14-Interpolation.html#sec-blockkriging"><span>Section&nbsp;12.5</span></a>)</li>
</ul>
<p>Alternative disaggregation methods include:</p>
<ul>
<li>deterministic, smoothing-based approaches such as kernel- or spline-based smoothing methods <span class="citation" data-cites="toblerpyc martin89">(<a href="references.html#ref-toblerpyc" role="doc-biblioref">Tobler 1979</a>; <a href="references.html#ref-martin89" role="doc-biblioref">Martin 1989</a>)</span></li>
<li>statistical, model-based approaches: area-to-area and area-to-point kriging <span class="citation" data-cites="kyriakidis04 stcos">(<a href="references.html#ref-kyriakidis04" role="doc-biblioref">Kyriakidis 2004</a>; <a href="references.html#ref-stcos" role="doc-biblioref">Raim et al. 2021</a>)</span>.<br>
## Exercises</li>
</ul>
<p>Where relevant, try to make the following exercises with R.</p>
<ol type="1">
<li>When we add a variable to the <code>nc</code> dataset by <code>nc$State = "North Carolina"</code> (i.e., all counties get assigned the same state name). Which value would you attach to this variable for the attribute-geometry relationship (agr)?</li>
<li>Create a new <code>sf</code> object from the geometry obtained by <code>st_union(nc)</code>, and assign <code>"North Carolina"</code> to the variable <code>State</code>. Which <code>agr</code> can you now assign to this attribute variable?</li>
<li>Use <code>st_area</code> to add a variable with name <code>area</code> to <code>nc</code>. Compare the <code>area</code> and <code>AREA</code> variables in the <code>nc</code> dataset. What are the units of <code>AREA</code>? Are the two linearly related? If there are discrepancies, what could be the cause?</li>
<li>Is the <code>area</code> variable intensive or extensive? Is its agr equal to <code>constant</code>, <code>identity</code> or <code>aggregate</code>?</li>
<li>Consider <a href="#fig-awiex">Figure&nbsp;<span>5.3</span></a> ; using the equations in <a href="#sec-extensiveintensive"><span>Section&nbsp;5.3.1</span></a>, compute the area-weighted interpolations for (a) the dashed cell and (b) for the square enclosing all four solid cells, first for the case where the four cells represent (i) an extensive variable, and (ii) an intensive variable. The red numbers are the data values of the source areas.</li>
</ol>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">st_make_grid</span>(<span class="fu">st_bbox</span>(<span class="fu">st_as_sfc</span>(<span class="st">"LINESTRING(0 0,1 1)"</span>)), <span class="at">n =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">4</span>))</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(g)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(g[<span class="dv">1</span>] <span class="sc">*</span> <span class="fu">diag</span>(<span class="fu">c</span>(<span class="dv">3</span><span class="sc">/</span><span class="dv">4</span>, <span class="dv">1</span>)) <span class="sc">+</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.125</span>), <span class="at">add =</span> <span class="cn">TRUE</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fu">c</span>(.<span class="dv">2</span>, .<span class="dv">8</span>, .<span class="dv">2</span>, .<span class="dv">8</span>), <span class="fu">c</span>(.<span class="dv">2</span>, .<span class="dv">2</span>, .<span class="dv">8</span>, .<span class="dv">8</span>), <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">8</span>), <span class="at">col =</span> <span class="st">'red'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-awiex" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="05-Attributes_files/figure-html/fig-awiex-1.png" class="img-fluid figure-img" style="width:50.0%"></p>
<p></p><figcaption class="figure-caption">Figure 5.3: example data for area-weighted interpolation</figcaption><p></p>
</figure>
</div>
</div>
</div>
<!--
* Find the name of the county that contains `POINT(-78.34046 35.017)`
* Find the names of all counties with boundaries that touch county `Sampson`.
* List the names of all counties that are less than 50 km away from county `Sampson`.
-->


<div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography" style="display: none">
<div id="ref-brus2021" class="csl-entry" role="doc-biblioentry">
Brus, Dick J. 2021. <span>“Statistical Approaches for Spatial Sample Survey: Persistent Misconceptions and New Developments.”</span> <em>European Journal of Soil Science</em> 72 (2): 686–703. https://doi.org/<a href="https://doi.org/10.1111/ejss.12988">https://doi.org/10.1111/ejss.12988</a>.
</div>
<div id="ref-Do2021" class="csl-entry" role="doc-biblioentry">
Do, Van Huyen, Thibault Laurent, and Anne Vanhems. 2021. <span>“Guidelines on Areal Interpolation Methods.”</span> In <em>Advances in Contemporary Statistics and Econometrics: Festschrift in Honor of Christine Thomas-Agnan</em>, edited by Abdelaati Daouia and Anne Ruiz-Gazen, 385–407. Cham: Springer International Publishing. <a href="https://doi.org/10.1007/978-3-030-73249-3_20">https://doi.org/10.1007/978-3-030-73249-3_20</a>.
</div>
<div id="ref-thomas" class="csl-entry" role="doc-biblioentry">
Do, Van Huyen, Christine Thomas-Agnan, and Anne Vanhems. 2015a. <span>“Accuracy of Areal Interpolation Methods for Count Data.”</span> <em>Spatial Statistics</em> 14: 412–38. <a href="https://doi.org/10.1016/j.spasta.2015.07.005">https://doi.org/10.1016/j.spasta.2015.07.005</a>.
</div>
<div id="ref-do" class="csl-entry" role="doc-biblioentry">
———. 2015b. <span>“Spatial Reallocation of Areal Data: A Review.”</span> <em>Rev. Econ. Rég. Urbaine</em> 1/2: 27–58. <a href="https://www.tse-fr.eu/sites/default/files/medias/doc/wp/mad/wp_tse_397_v2.pdf">https://www.tse-fr.eu/sites/default/files/medias/doc/wp/mad/wp_tse_397_v2.pdf</a>.
</div>
<div id="ref-goodchild" class="csl-entry" role="doc-biblioentry">
Goodchild, Michael F, and Nina Siu Ngan Lam. 1980. <em>Areal Interpolation: A Variant of the Traditional Spatial Problem</em>. Department of Geography, University of Western Ontario London, ON, Canada.
</div>
<div id="ref-kyriakidis04" class="csl-entry" role="doc-biblioentry">
Kyriakidis, P. C. 2004. <span>“A Geostatistical Framework for Areal-to-Point Spatial Interpolation.”</span> <em>Geographical Analysis</em> 36: 259–89.
</div>
<div id="ref-martin89" class="csl-entry" role="doc-biblioentry">
Martin, D. 1989. <span>“Mapping Population Data from Zone Centroid Locations.”</span> <em>Transactions of the Institute of British Geographers, New Series</em> 14: 90–97.
</div>
<div id="ref-mennis" class="csl-entry" role="doc-biblioentry">
Mennis, Jeremy. 2003. <span>“Generating Surface Models of Population Using Dasymetric Mapping.”</span> <em>The Professional Geographer</em> 55 (1): 31–42.
</div>
<div id="ref-stcos" class="csl-entry" role="doc-biblioentry">
Raim, A. M., S. H. Holan, J. R. Bradley, and C. K. Wikle. 2021. <span>“Spatio-Temporal Change of Support Modeling with r.”</span> <em>Computational Statistics</em> 36: 749–80. https://doi.org/<a href=" https://doi.org/10.1007/s00180-020-01029-4 ">https://doi.org/10.1007/s00180-020-01029-4 </a>.
</div>
<div id="ref-scheider2016" class="csl-entry" role="doc-biblioentry">
Scheider, Simon, Benedikt Gräler, Edzer Pebesma, and Christoph Stasch. 2016. <span>“Modeling Spatiotemporal Information Generation.”</span> <em>International Journal of Geographical Information Science</em> 30 (10): 1980–2008. <a href="https://doi.org/10.1080/13658816.2016.1151520">https://doi.org/10.1080/13658816.2016.1151520</a>.
</div>
<div id="ref-stasch2014" class="csl-entry" role="doc-biblioentry">
Stasch, Christoph, Simon Scheider, Edzer Pebesma, and Werner Kuhn. 2014. <span>“Meaningful Spatial Prediction and Aggregation.”</span> <em>Environmental Modelling &amp; Software</em> 51: 149–65. <a href="https://doi.org/10.1016/j.envsoft.2013.09.006">https://doi.org/10.1016/j.envsoft.2013.09.006</a>.
</div>
<div id="ref-toblerpyc" class="csl-entry" role="doc-biblioentry">
Tobler, W. R. 1979. <span>“Smooth Pycnophylactic Interpolation for Geographical Regions.”</span> <em>Journal of the American Statistical Association</em> 74: 519–30.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./04-Spherical.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Spherical Geometries</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./06-part-2.html" class="pagination-link">
        <span class="nav-page-text">R for Spatial Data Science</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>